{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/User/Desktop/Book Land/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/User/Desktop/Book Land/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/User/Desktop/Book Land/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useRef,useState}from'react';import{useCancelPromise}from'./useCancelPromise';export function useApi(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var cancelPromise=useCancelPromise();var errorRef=useRef();// Making an api call and returning loading , error.\nvar makeApiCall=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(apiCall){var response,_err$response,_error;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:setIsLoading(true);setError('');_context2.prev=2;_context2.next=5;return new Promise(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(resolve,reject){var data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return apiCall();case 3:data=_context.sent;resolve(data);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);reject(_context.t0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function(_x2,_x3){return _ref2.apply(this,arguments);};}());case 5:response=_context2.sent;setIsLoading(false);setError('');errorRef.current=null;return _context2.abrupt(\"return\",response);case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](2);if(!cancelPromise.current){setIsLoading(false);_error=(_context2.t0===null||_context2.t0===void 0?void 0:(_err$response=_context2.t0.response)===null||_err$response===void 0?void 0:_err$response.data)||'An error occured. Please try again later';setError(_error);errorRef.current=_error;}case 15:case\"end\":return _context2.stop();}},_callee2,null,[[2,12]]);}));return function makeApiCall(_x){return _ref.apply(this,arguments);};}();return[isLoading,error,makeApiCall,setError,errorRef];}","map":{"version":3,"names":["useRef","useState","useCancelPromise","useApi","_useState","_useState2","_slicedToArray","isLoading","setIsLoading","_useState3","_useState4","error","setError","cancelPromise","errorRef","makeApiCall","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","apiCall","response","_err$response","_error","wrap","_callee2$","_context2","prev","next","Promise","_ref2","_callee","resolve","reject","data","_callee$","_context","sent","t0","stop","_x2","_x3","apply","arguments","current","abrupt","_x"],"sources":["C:/Users/User/Desktop/Book Land/client/src/hooks/useApi.js"],"sourcesContent":["import { useRef, useState } from 'react';\nimport { useCancelPromise } from './useCancelPromise';\n\nexport function useApi() {\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState();\n  const cancelPromise = useCancelPromise();\n  const errorRef = useRef();\n\n  // Making an api call and returning loading , error.\n  const makeApiCall = async (apiCall) => {\n    setIsLoading(true);\n    setError('');\n\n    try {\n      const response = await new Promise(async (resolve, reject) => {\n        try {\n          const data = await apiCall();\n          resolve(data);\n        } catch (err) {\n          reject(err);\n        }\n      });\n      setIsLoading(false);\n      setError('');\n      errorRef.current = null;\n      return response;\n    } catch (err) {\n      if (!cancelPromise.current) {\n        setIsLoading(false);\n        const error =\n          err?.response?.data || 'An error occured. Please try again later';\n        setError(error);\n        errorRef.current = error;\n      }\n    }\n  };\n\n  return [isLoading, error, makeApiCall, setError, errorRef];\n}\n"],"mappings":"oYAAA,OAASA,MAAM,CAAEC,QAAQ,KAAQ,OAAO,CACxC,OAASC,gBAAgB,KAAQ,oBAAoB,CAErD,MAAO,SAAS,CAAAC,MAAMA,CAAA,CAAG,CACvB,IAAAC,SAAA,CAAkCH,QAAQ,CAAC,KAAK,CAAC,CAAAI,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA1CG,SAAS,CAAAF,UAAA,IAAEG,YAAY,CAAAH,UAAA,IAC9B,IAAAI,UAAA,CAA0BR,QAAQ,EAAE,CAAAS,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA7BE,KAAK,CAAAD,UAAA,IAAEE,QAAQ,CAAAF,UAAA,IACtB,GAAM,CAAAG,aAAa,CAAGX,gBAAgB,EAAE,CACxC,GAAM,CAAAY,QAAQ,CAAGd,MAAM,EAAE,CAEzB;AACA,GAAM,CAAAe,WAAW,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,SAAOC,OAAO,MAAAC,QAAA,CAAAC,aAAA,CAAAC,MAAA,QAAAN,mBAAA,GAAAO,IAAA,UAAAC,UAAAC,SAAA,iBAAAA,SAAA,CAAAC,IAAA,CAAAD,SAAA,CAAAE,IAAA,SAChCrB,YAAY,CAAC,IAAI,CAAC,CAClBI,QAAQ,CAAC,EAAE,CAAC,CAACe,SAAA,CAAAC,IAAA,GAAAD,SAAA,CAAAE,IAAA,SAGY,IAAI,CAAAC,OAAO,6BAAAC,KAAA,CAAAd,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAC,SAAAa,QAAOC,OAAO,CAAEC,MAAM,MAAAC,IAAA,QAAAjB,mBAAA,GAAAO,IAAA,UAAAW,SAAAC,QAAA,iBAAAA,QAAA,CAAAT,IAAA,CAAAS,QAAA,CAAAR,IAAA,SAAAQ,QAAA,CAAAT,IAAA,GAAAS,QAAA,CAAAR,IAAA,SAElC,CAAAR,OAAO,EAAE,QAAtBc,IAAI,CAAAE,QAAA,CAAAC,IAAA,CACVL,OAAO,CAACE,IAAI,CAAC,CAACE,QAAA,CAAAR,IAAA,iBAAAQ,QAAA,CAAAT,IAAA,GAAAS,QAAA,CAAAE,EAAA,CAAAF,QAAA,aAEdH,MAAM,CAAAG,QAAA,CAAAE,EAAA,CAAK,CAAC,yBAAAF,QAAA,CAAAG,IAAA,MAAAR,OAAA,gBAEf,mBAAAS,GAAA,CAAAC,GAAA,SAAAX,KAAA,CAAAY,KAAA,MAAAC,SAAA,QAAC,QAPItB,QAAQ,CAAAK,SAAA,CAAAW,IAAA,CAQd9B,YAAY,CAAC,KAAK,CAAC,CACnBI,QAAQ,CAAC,EAAE,CAAC,CACZE,QAAQ,CAAC+B,OAAO,CAAG,IAAI,CAAC,OAAAlB,SAAA,CAAAmB,MAAA,UACjBxB,QAAQ,UAAAK,SAAA,CAAAC,IAAA,IAAAD,SAAA,CAAAY,EAAA,CAAAZ,SAAA,aAEf,GAAI,CAACd,aAAa,CAACgC,OAAO,CAAE,CAC1BrC,YAAY,CAAC,KAAK,CAAC,CACbG,MAAK,CACT,CAAAgB,SAAA,CAAAY,EAAA,SAAAZ,SAAA,CAAAY,EAAA,kBAAAhB,aAAA,CAAAI,SAAA,CAAAY,EAAA,CAAKjB,QAAQ,UAAAC,aAAA,iBAAbA,aAAA,CAAeY,IAAI,GAAI,0CAA0C,CACnEvB,QAAQ,CAACD,MAAK,CAAC,CACfG,QAAQ,CAAC+B,OAAO,CAAGlC,MAAK,CAC1B,CAAC,yBAAAgB,SAAA,CAAAa,IAAA,MAAApB,QAAA,iBAEJ,kBA1BK,CAAAL,WAAWA,CAAAgC,EAAA,SAAA/B,IAAA,CAAA2B,KAAA,MAAAC,SAAA,OA0BhB,CAED,MAAO,CAACrC,SAAS,CAAEI,KAAK,CAAEI,WAAW,CAAEH,QAAQ,CAAEE,QAAQ,CAAC,CAC5D"},"metadata":{},"sourceType":"module","externalDependencies":[]}